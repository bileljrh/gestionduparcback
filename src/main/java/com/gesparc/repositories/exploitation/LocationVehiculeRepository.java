package com.gesparc.repositories.exploitation;

import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.PagingAndSortingRepository;
import org.springframework.stereotype.Repository;

import com.gesparc.entities.exploitation.LocationVehiculeEntity;
import com.gesparc.entities.referentiel.StructureEntity;

import java.time.LocalDate;


@EnableAutoConfiguration
@Repository
public interface LocationVehiculeRepository extends PagingAndSortingRepository<LocationVehiculeEntity, Long> {

    @Query(value = "select min(date_debut_location) from location_vehicule", nativeQuery = true)
    LocalDate getDateMinDateDebutLocation();

    @Query(value = "select max(date_fin_location) from location_vehicule", nativeQuery = true)
    LocalDate getDateMaxDateFinLocation();

    @Query(value = "select * from location_vehicule where (date_debut_location > ?1) and (date_fin_location < ?2)", nativeQuery = true)
    Page<LocationVehiculeEntity> getPaginationLocationVehiculeList(LocalDate dateMin, LocalDate dateMax, Pageable pageable);


    Page<LocationVehiculeEntity> findAllByStructureAndDateDebutLocationBetween(StructureEntity structureEntity, LocalDate dateDebut, LocalDate dateFin, Pageable page);

    Page<LocationVehiculeEntity> findAllByDateDebutLocationBetween(LocalDate dateDebut, LocalDate dateFin, Pageable page);

}
